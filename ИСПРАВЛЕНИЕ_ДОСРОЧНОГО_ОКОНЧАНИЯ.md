# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ö–Ω–æ–ø–∫–∞ –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞

**–î–∞—Ç–∞:** 15 –Ω–æ—è–±—Ä—è 2025

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–≥–¥–∞ –Ω–∞–∂–∏–º–∞–ª–∏ –æ—Ä–∞–Ω–∂–µ–≤—É—é –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–¥—É–∫—Ç –∑–∞–∫–æ–Ω—á–∏–ª—Å—è —Ä–∞–Ω—å—à–µ" –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–æ–¥—É–∫—Ç–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–í –Ω–∞–ª–∏—á–∏–∏", –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ. –ö–Ω–æ–ø–∫–∞ –Ω–µ –º–µ–Ω—è–ª–∞ —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–¥—É–∫—Ç–∞, –¥–∞–∂–µ –ø—Ä–∏ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–º –Ω–∞–∂–∞—Ç–∏–∏.

### –ü—Ä–∏–º–µ—Ä
- –ö—Ä–µ–≤–µ—Ç–∫–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ "–í –Ω–∞–ª–∏—á–∏–∏" (ok)
- –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∫—Ä–µ–≤–µ—Ç–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å
- –ù–∞–∂–∏–º–∞–µ–º –æ—Ä–∞–Ω–∂–µ–≤—É—é –∫–Ω–æ–ø–∫—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- ‚ùå **–ù–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç** - —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–µ—Ç—Å—è "–í –Ω–∞–ª–∏—á–∏–∏"

## –ü—Ä–∏—á–∏–Ω–∞

–ë—ã–ª–∞ –æ—à–∏–±–∫–∞ –≤ –ª–æ–≥–∏–∫–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ–¥—É–∫—Ç–∞:

**–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä—è–ª–æ—Å—å, –∫–æ–≥–¥–∞ –±—ã–ª –∫—É–ø–ª–µ–Ω –ø—Ä–æ–¥—É–∫—Ç
2. –ï—Å–ª–∏ –∫—É–ø–ª–µ–Ω –Ω–µ–¥–∞–≤–Ω–æ (—Å–µ–≥–æ–¥–Ω—è –∏–ª–∏ –≤—á–µ—Ä–∞) ‚Üí —Å—Ç–∞—Ç—É—Å **–í–°–ï–ì–î–ê** `'ok'`
3. –¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –ø—Ä–æ–≤–µ—Ä—è–ª—Å—è —Å—Ä–æ–∫ –æ–∫–æ–Ω—á–∞–Ω–∏—è

**–ß—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫:**
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∫—É–ø–∫–∏ –Ω–∞ "—Å–µ–≥–æ–¥–Ω—è"
- –°–∏—Å—Ç–µ–º–∞ –≤–∏–¥–µ–ª–∞ "–ø—Ä–æ–¥—É–∫—Ç –∫—É–ø–ª–µ–Ω —Å–µ–≥–æ–¥–Ω—è" ‚Üí –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–≤–∏–ª–∞ —Å—Ç–∞—Ç—É—Å `'ok'`
- –î–∞–∂–µ –µ—Å–ª–∏ `predicted_end` —É–∂–µ –ø—Ä–æ—à–µ–ª!

**–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫?**
- –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫, —Ç–æ –ø—Ä–æ–¥—É–∫—Ç —Å –º–∞–ª–µ–Ω—å–∫–∏–º `avg_days` (1 –¥–µ–Ω—å) —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ –±—É–¥–µ—Ç –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ "–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è"
- –ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—é: **–æ–±—ã—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏** –∏–∑ —á–µ–∫–æ–≤ –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å `'ok'` –º–∏–Ω–∏–º—É–º 2 –¥–Ω—è

## –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ **—Ç–∏–ø–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏** –≤ –∏—Å—Ç–æ—Ä–∏–∏:

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å: —ç—Ç–æ –¥–æ—Å—Ä–æ—á–Ω–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ (`quantity=-1`)?
2. ‚úÖ –ï—Å–ª–∏ –ø—Ä–æ–¥—É–∫—Ç –∫—É–ø–ª–µ–Ω –Ω–µ–¥–∞–≤–Ω–æ –ò —ç—Ç–æ **–ù–ï** –¥–æ—Å—Ä–æ—á–Ω–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ ‚Üí —Å—Ç–∞—Ç—É—Å `'ok'` (–≥–∞—Ä–∞–Ω—Ç–∏—è 2 –¥–Ω—è)
3. ‚úÖ –ò–Ω–∞—á–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–æ–∫ –æ–∫–æ–Ω—á–∞–Ω–∏—è

**–¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –æ–±–∞ —Å–ª—É—á–∞—è:**
- üõí **–û–±—ã—á–Ω–∞—è –ø–æ–∫—É–ø–∫–∞:** –≥–∞—Ä–∞–Ω—Ç–∏—è –º–∏–Ω–∏–º—É–º 2 –¥–Ω—è —Å—Ç–∞—Ç—É—Å–∞ `'ok'` (–¥–∞–∂–µ –µ—Å–ª–∏ avg_days = 1 –¥–µ–Ω—å)
- ‚ö†Ô∏è **–î–æ—Å—Ä–æ—á–Ω–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ:** —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `'ending-soon'` –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥–∞—Ç—ã –ø–æ–∫—É–ø–∫–∏

## –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### –§–∞–π–ª: `/src/services/supabaseService.ts`
- **–ú–µ—Ç–æ–¥:** `calculateProductStats()` (—Å—Ç—Ä–æ–∫–∏ 337-350)
- **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `isEarlyDepletion` (–ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å —Å `quantity=-1`)

### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

**–ü—Ä–∏–º–µ—Ä 1: –û–±—ã—á–Ω–∞—è –ø–æ–∫—É–ø–∫–∞ —Ö–ª–µ–±–∞**
```
- –ö—É–ø–∏–ª–∏ —Ö–ª–µ–± —Å–µ–≥–æ–¥–Ω—è ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å quantity=2
- avg_days = 1 –¥–µ–Ω—å (—Ö–ª–µ–± –µ–¥—è—Ç –±—ã—Å—Ç—Ä–æ)
- predicted_end = –∑–∞–≤—Ç—Ä–∞
- isEarlyDepletion = false (–ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å quantity=2, –Ω–µ -1)
- ‚úÖ –°—Ç–∞—Ç—É—Å = 'ok' (–≥–∞—Ä–∞–Ω—Ç–∏—è 2 –¥–Ω—è —Ä–∞–±–æ—Ç–∞–µ—Ç!)
```

**–ü—Ä–∏–º–µ—Ä 2: –ö—Ä–µ–≤–µ—Ç–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å —Ä–∞–Ω—å—à–µ**
```
- –ù–∞–∂–∞–ª–∏ –∫–Ω–æ–ø–∫—É –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å quantity=-1
- last_purchase –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
- avg_days –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω (—É–º–µ–Ω—å—à–∏–ª—Å—è)
- isEarlyDepletion = true (–ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å quantity=-1)
- ‚úÖ –°—Ç–∞—Ç—É—Å = 'ending-soon' (–∫–Ω–æ–ø–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!)
```

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–í –Ω–∞–ª–∏—á–∏–∏" (–∑–µ–ª–µ–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞)
3. –ù–∞–∂–º–∏—Ç–µ –æ—Ä–∞–Ω–∂–µ–≤—É—é –∫–Ω–æ–ø–∫—É —Å —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–º –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É
4. **–¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:**
   - ‚úÖ –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è" (–æ—Ä–∞–Ω–∂–µ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞)
   - ‚úÖ –û—Ä–∞–Ω–∂–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç
   - ‚úÖ –ü–æ—è–≤–ª—è–µ—Ç—Å—è –∑–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–ü—Ä–æ–¥—É–∫—Ç –µ—â–µ –µ—Å—Ç—å"
   - ‚úÖ –£–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ø—Ä–æ–≥–Ω–æ–∑ (`avg_days`)

## –î–µ–ø–ª–æ–π

```bash
# 1. –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add src/services/supabaseService.ts FIX_EARLY_DEPLETION_BUTTON.md –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_–î–û–°–†–û–ß–ù–û–ì–û_–û–ö–û–ù–ß–ê–ù–ò–Ø.md

# 2. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git commit -m "fix: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞"

# 3. –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å
git push origin main
```

Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–µ—Ä–µ—Ç –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è.

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

–ü–æ–¥—Ä–æ–±–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `FIX_EARLY_DEPLETION_BUTTON.md`

