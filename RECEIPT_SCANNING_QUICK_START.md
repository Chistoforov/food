# Quick Start: Receipt Scanning

## –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ö–∞–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —á–µ–∫

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **"–ß–µ–∫"** (–∏–∫–æ–Ω–∫–∞ –∫–∞–º–µ—Ä—ã)

2. **–°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ —á–µ–∫** –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ:
   - –ù–∞–∂–º–∏—Ç–µ **"–ö–∞–º–µ—Ä–∞"** —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ
   - –ù–∞–∂–º–∏—Ç–µ **"–ì–∞–ª–µ—Ä–µ—è"** —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ñ–æ—Ç–æ

3. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ** 5-15 —Å–µ–∫—É–Ω–¥ –ø–æ–∫–∞ AI –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–µ–∫

4. **–ì–æ—Ç–æ–≤–æ!** –í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –≤–∞—à —Å–ø–∏—Å–æ–∫

### –°–æ–≤–µ—Ç—ã –¥–ª—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
- –•–æ—Ä–æ—à–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ
- –ß–µ–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –∫–∞–¥—Ä–µ
- –ß–µ–∫ –Ω–∞ –ø–ª–æ—Å–∫–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
- –ß–µ—Ç–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–±–µ–∑ —Ä–∞–∑–º—ã—Ç–∏—è)

‚ùå **–ò–∑–±–µ–≥–∞–π—Ç–µ:**
- –¢–µ–º–Ω—ã–µ –∏–ª–∏ —Ä–∞–∑–º—ã—Ç—ã–µ —Ñ–æ—Ç–æ
- –ú—è—Ç—ã–µ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —á–µ–∫–∏
- –ß–∞—Å—Ç–∏—á–Ω–æ –æ–±—Ä–µ–∑–∞–Ω–Ω—ã–µ —á–µ–∫–∏

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç AI

AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç:
- üè∑Ô∏è –ù–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- üì¶ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (–∫–≥, –ª, —à—Ç)
- üí∞ –¶–µ–Ω—ã
- üî• –ö–∞–ª–æ—Ä–∏–∏ –¥–ª—è **–ø–æ–ª–Ω–æ–≥–æ –∫—É–ø–ª–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–º–∞**
- üìÖ –î–∞—Ç—É –ø–æ–∫—É–ø–∫–∏

### –ü—Ä–∏–º–µ—Ä

**–í–∞—à —á–µ–∫:**
```
–ú–æ–ª–æ–∫–æ 3.2% 1L    ‚Ç¨1.89
–•–ª–µ–± –±–µ–ª—ã–π        ‚Ç¨1.25
–¢–≤–æ—Ä–æ–≥ 500–≥       ‚Ç¨2.49
-------------------------
–ò–¢–û–ì–û:            ‚Ç¨5.63
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:**
- –ú–æ–ª–æ–∫–æ 3.2% 1L ‚Üí 1 –ª ‚Üí ‚Ç¨1.89 ‚Üí 620 –∫–∫–∞–ª (–¥–ª—è 1000–º–ª)
- –•–ª–µ–± –±–µ–ª—ã–π ‚Üí 1 —à—Ç ‚Üí ‚Ç¨1.25 ‚Üí 1200 –∫–∫–∞–ª (–¥–ª—è –≤—Å–µ–π –±—É—Ö–∞–Ω–∫–∏)
- –¢–≤–æ—Ä–æ–≥ 500–≥ ‚Üí 0.5 –∫–≥ ‚Üí ‚Ç¨2.49 ‚Üí 680 –∫–∫–∞–ª (–¥–ª—è 500–≥)

## –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

```typescript
import { parseReceiptImage } from './services/perplexityService';
import { SupabaseService } from './services/supabaseService';

// 1. Parse receipt image
const parsedReceipt = await parseReceiptImage(imageFile);

// 2. Process and save to database
await SupabaseService.processReceipt(
  familyId,
  parsedReceipt.items,
  parsedReceipt.total,
  parsedReceipt.date || new Date().toISOString().split('T')[0]
);

// 3. Done! Data is now in your database
```

### API Response Format

```typescript
interface ParsedReceipt {
  items: Array<{
    name: string;      // "–ú–æ–ª–æ–∫–æ 3.2% 1L"
    quantity: number;  // 1
    unit: string;      // "–ª"
    price: number;     // 1.89
    calories: number;  // 620 (for full quantity)
  }>;
  total: number;       // 5.63
  date?: string;       // "2024-10-28"
}
```

### Environment Setup

The Perplexity API key is currently hardcoded in `perplexityService.ts`.

For production, move it to environment variables:

```env
# .env.local
VITE_PERPLEXITY_API_KEY=your_api_key_here
```

```typescript
// perplexityService.ts
const PERPLEXITY_API_KEY = import.meta.env.VITE_PERPLEXITY_API_KEY;
```

### Testing

Use the mock function for testing without API calls:

```typescript
import { parseReceiptImageMock } from './services/perplexityService';

// Returns sample data instantly
const mockReceipt = await parseReceiptImageMock(imageFile);
```

### Error Handling

The service includes comprehensive error handling:

```typescript
try {
  const receipt = await parseReceiptImage(file);
  // Success handling
} catch (error) {
  if (error instanceof Error) {
    console.error('Parsing error:', error.message);
  }
  // Error handling
}
```

Common errors:
- Invalid file type
- File too large (>10MB)
- Network/API errors
- Invalid JSON response

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
User selects image
       ‚Üì
Input validation
       ‚Üì
Convert to base64
       ‚Üì
Perplexity API call
       ‚Üì
Parse JSON response
       ‚Üì
Create/update products
       ‚Üì
Add purchase history
       ‚Üì
Update statistics
       ‚Üì
Show success message
```

### Database Updates

–ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —á–µ–∫–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è:

1. **`receipts`** - –Ω–æ–≤—ã–π —á–µ–∫
2. **`products`** - —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
3. **`product_history`** - –∑–∞–ø–∏—Å—å –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–∏
4. **`monthly_stats`** - –ø–µ—Ä–µ—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### Performance

- Image conversion: ~100-500ms
- API call: ~5-15s
- Database operations: ~1-2s
- **Total: ~6-18s**

## FAQ

**Q: –ü–æ—á–µ–º—É –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç —Ç–∞–∫ –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏?**
A: AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ç–µ–∫—Å—Ç, —Ü–µ–Ω—ã –∏ –ø—Ä–æ–¥—É–∫—Ç—ã. –≠—Ç–æ —Å–ª–æ–∂–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?**
A: –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ - –Ω–µ—Ç. –ù–æ –≤—ã –º–æ–∂–µ—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ü—Ä–æ–¥—É–∫—Ç—ã".

**Q: –ß—Ç–æ –µ—Å–ª–∏ AI –æ—à–∏–±—Å—è?**
A: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É "–ü—Ä–æ–¥—É–∫—Ç—ã" –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é.

**Q: –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–∏ —Ñ–æ—Ç–æ —á–µ–∫–æ–≤?**
A: –ù–µ—Ç, –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –æ—Ñ–ª–∞–π–Ω?**
A: –ù–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è —Ä–∞–±–æ—Ç—ã AI.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–æ–±–ª–µ–º—ã? –°–º. [TROUBLESHOOTING.md](./TROUBLESHOOTING.md) –∏–ª–∏ [RECEIPT_SCANNING.md](./RECEIPT_SCANNING.md)

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞:** October 2024  
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ

