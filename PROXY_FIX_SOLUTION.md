# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "Failed to fetch" –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —á–µ–∫–∞

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —á–µ–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ "Failed to fetch" –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –º–æ–≥ –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä—É –Ω–∞ `localhost:3001`.

## –†–µ—à–µ–Ω–∏–µ
–ù–∞—Å—Ç—Ä–æ–µ–Ω **Vite proxy** –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ `/api/perplexity` –Ω–∞ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä.

## –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### 1. `vite.config.ts`
–î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–∫—Å–∏ –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:
```typescript
export default defineConfig({
  plugins: [react()],
  server: {
    port: 5177,
    proxy: {
      '/api/perplexity': {
        target: 'http://localhost:3001',
        changeOrigin: true,
        secure: false,
      }
    }
  }
})
```

### 2. `src/services/perplexityService.ts`
–ò–∑–º–µ–Ω–µ–Ω URL –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å:
```typescript
// –ë—ã–ª–æ:
const PROXY_URL = import.meta.env.PROD 
  ? '/api/perplexity' 
  : (import.meta.env.VITE_PROXY_URL || 'http://localhost:3001/api/perplexity');

// –°—Ç–∞–ª–æ:
const PROXY_URL = '/api/perplexity';
```

–¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —É–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –®–∞–≥ 1: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å `.env.local` —Å API –∫–ª—é—á–∞–º–∏

–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
```bash
VITE_SUPABASE_URL=https://ynwccktrpypybqhfloac.supabase.co
VITE_SUPABASE_ANON_KEY=your_supabase_key
VITE_PERPLEXITY_API_KEY=your_perplexity_key
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
```bash
npm run proxy
```

–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
üöÄ Proxy server running on http://localhost:3001
üì° Forwarding requests to Perplexity API
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
```bash
npm run dev
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞ `http://localhost:5177`

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ß–µ–∫" (–∫–∞–º–µ—Ä–∞)
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ —á–µ–∫–∞
4. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏:
   - `Making request to: /api/perplexity`
   - –î–∞–ª–µ–µ –æ—Ç–≤–µ—Ç –æ—Ç API

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–æ–∫—Å–∏ –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:
```bash
curl -X POST http://localhost:5177/api/perplexity \
  -H "Content-Type: application/json" \
  -d '{"model":"sonar-pro","messages":[{"role":"user","content":"test"}]}'
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON –æ—Ç–≤–µ—Ç –æ—Ç Perplexity API.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–ë—Ä–∞—É–∑–µ—Ä (localhost:5177)
    ‚Üì
    ‚îî‚îÄ‚Üí /api/perplexity (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å)
            ‚Üì
        Vite Proxy (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç)
            ‚Üì
        –ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä (localhost:3001)
            ‚Üì
        Perplexity API (https://api.perplexity.ai)
```

## –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (Vercel)

–ù–∞ Vercel —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ:
- –ó–∞–ø—Ä–æ—Å—ã –∫ `/api/perplexity` –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ serverless —Ñ—É–Ω–∫—Ü–∏—é `proxy-server.js`
- –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω:**
   ```bash
   lsof -i :3001
   ```
   
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Vite —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   ```bash
   lsof -i :5177
   ```
   
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12)**

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞** –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –æ–Ω –∑–∞–ø—É—â–µ–Ω

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- ‚úÖ `vite.config.ts` - –¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–∫—Å–∏
- ‚úÖ `src/services/perplexityService.ts` - –∏–∑–º–µ–Ω–µ–Ω URL –∏ —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

