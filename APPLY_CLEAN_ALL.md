# Полная очистка (Debug)

Чтобы понять, что происходит, давайте удалим **всё**, что связано с автоматическим созданием пользователя, и проверим, исчезнет ли ошибка.

1. Откройте **SQL Editor** в Supabase.
2. Выполните код из файла `CLEAN_ALL_AUTH.sql` (или ниже):

```sql
-- CLEANUP SCRIPT
-- 1. Удаляем триггер
DROP TRIGGER IF EXISTS on_auth_user_created ON auth.users;

-- 2. Удаляем все функции
DROP FUNCTION IF EXISTS public.handle_new_user() CASCADE;
DROP FUNCTION IF EXISTS public.handle_new_user_v2() CASCADE;
DROP FUNCTION IF EXISTS public.handle_new_user_v3() CASCADE;
```

**После выполнения этого скрипта:**
1. Попробуйте войти в приложение.
2. **Ожидание:** Вы должны успешно войти, НО увидите "бесконечную загрузку" или пустой экран (потому что профиль не создастся).
3. **Главное:** Ошибка `Database error saving new user` **должна исчезнуть**.

Если ошибка исчезнет — напишите мне, и мы накатим исправленную версию (V3) начисто.
Если ошибка ОСТАНЕТСЯ — значит, в базе есть **ещё один секретный триггер**, о котором мы не знаем. В этом случае пришлите скриншот результата первого запроса из `CLEAN_ALL_AUTH.sql`.

