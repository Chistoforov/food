# üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –∫—ç—à–∞ –ø—Ä–∏ –ø–µ—Ä–µ–ª–æ–≥–∏–Ω–µ

## üìã –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±—Ä–æ—Å–∞ –∫—ç—à–∞ –∏ –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Logout -> Login), –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å–µ—Å—Å–∏–∏.

### üõ† –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

1. **–ù–æ–≤—ã–π —É—Ç–∏–ª–∏—Ç–Ω—ã–π —Ñ–∞–π–ª `src/utils/cacheHelper.ts`**:
   - –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `clearAppCache(familyId, preserveAuth)`, –∫–æ—Ç–æ—Ä–∞—è:
     - –û—á–∏—â–∞–µ—Ç Cache Storage (–∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞)
     - –û—á–∏—â–∞–µ—Ç localStorage, –Ω–æ —É–º–µ–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (`preserveAuth=true`) –∏ –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
     - –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–µ—Å—á–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (`recalculateFamilyAnalytics`)
     - –û–±–Ω–æ–≤–ª—è–µ—Ç Service Worker

2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `AuthContext.tsx`**:
   - –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ (`signOut`) —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `localStorage.setItem('needs_cache_reset', 'true')`.

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `GroceryTrackerApp.tsx`**:
   - –î–æ–±–∞–≤–ª–µ–Ω `useEffect`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–ª–∞–≥ `needs_cache_reset` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
   - –ï—Å–ª–∏ —Ñ–ª–∞–≥ –Ω–∞–π–¥–µ–Ω –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª:
     - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `clearAppCache` —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
     - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è.
   - –ö–Ω–æ–ø–∫–∞ "–°–±—Ä–æ—Å –∫—ç—à–∞" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é `clearAppCache`.

4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `AccountPage.tsx`**:
   - –ö–Ω–æ–ø–∫–∞ "–°–±—Ä–æ—Å –∫—ç—à–∞" –≤ –∞–∫–∫–∞—É–Ω—Ç–µ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `clearAppCache`.

### üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–í—ã–π—Ç–∏".
2. –í localStorage —Å—Ç–∞–≤–∏—Ç—Å—è –º–µ—Ç–∫–∞ `needs_cache_reset`.
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–Ω–æ–≤–∞ –≤—Ö–æ–¥–∏—Ç.
4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–∏–¥–∏—Ç –º–µ—Ç–∫—É, –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É –∫—ç—à–∞ –∏ –ø–µ—Ä–µ—Å—á–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –Ω–æ **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–µ—Å—Å–∏—é –≤—Ö–æ–¥–∞**.
5. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –æ—à–∏–±–æ–∫.

