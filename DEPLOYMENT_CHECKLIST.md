# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –¥–µ–ø–ª–æ—è —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–µ–∫–æ–≤

## –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 1. Supabase - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `migration_add_pending_receipts.sql`
- [ ] –¢–∞–±–ª–∏—Ü–∞ `pending_receipts` —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Ç–∞–±–ª–∏—Ü—É
SELECT * FROM pending_receipts LIMIT 1;
```

### 2. Supabase - Storage
- [ ] –°–æ–∑–¥–∞–Ω bucket `receipts`
- [ ] Bucket –ø—É–±–ª–∏—á–Ω—ã–π (Public: ‚úÖ)
- [ ] –õ–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞: 10 MB
- [ ] –°–æ–∑–¥–∞–Ω—ã 3 –ø–æ–ª–∏—Ç–∏–∫–∏ (INSERT, SELECT, DELETE)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. Storage ‚Üí receipts –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ
2. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é

### 3. Supabase - Realtime
- [ ] Realtime –≤–∫–ª—é—á–µ–Ω –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `pending_receipts`
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å pending_receipts
SELECT schemaname, tablename 
FROM pg_publication_tables 
WHERE pubname = 'supabase_realtime';
```

### 4. Vercel - Environment Variables
- [ ] `VITE_SUPABASE_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] `VITE_SUPABASE_ANON_KEY` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] `PERPLEXITY_API_KEY` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables
2. –í—Å–µ 3 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ

### 5. –ö–æ–¥
- [ ] –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã:
  - `migration_add_pending_receipts.sql`
  - `api/process-receipt.js`
- [ ] –§–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
  - `src/lib/supabase.ts` (–¥–æ–±–∞–≤–ª–µ–Ω PendingReceipt)
  - `src/services/supabaseService.ts` (–¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã)
  - `src/GroceryTrackerApp.tsx` (–æ–±–Ω–æ–≤–ª–µ–Ω UploadPage)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ TypeScript
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ ESLint

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
npm run build
# –î–æ–ª–∂–Ω–æ —É—Å–ø–µ—à–Ω–æ —Å–æ–±—Ä–∞—Ç—å—Å—è
```

## –î–µ–ø–ª–æ–π

### 1. –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
```bash
git status
git add .
git commit -m "Add background receipt processing"
```

### 2. Push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git push origin main
```

### 3. Vercel –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π
- [ ] Vercel –Ω–∞—á–∞–ª –¥–µ–ø–ª–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ (Status: Ready)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. Vercel Dashboard ‚Üí Deployments
2. –ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–µ–ª–µ–Ω—ã–º ‚úÖ

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoints
- [ ] `/api/perplexity` –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] `/api/process-receipt` –¥–æ—Å—Ç—É–ø–µ–Ω

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 405 (Method not allowed)
curl https://your-app.vercel.app/api/process-receipt

# –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –∑–Ω–∞—á–∏—Ç endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
```

## –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–∫–∞**
- [ ] –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ß–µ–∫"
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ —á–µ–∫–∞
- [ ] –£–≤–∏–¥–µ—Ç—å "–ß–µ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω!" —á–µ—Ä–µ–∑ 1-2 —Å–µ–∫
- [ ] –ß–µ–∫ –ø–æ—è–≤–∏–ª—Å—è –≤ —Å–ø–∏—Å–∫–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö

**–¢–µ—Å—Ç 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Ñ–æ–Ω–µ**
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ–∫
- [ ] –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –ü–æ–¥–æ–∂–¥–∞—Ç—å 15-30 —Å–µ–∫—É–Ω–¥
- [ ] –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–æ–≤–∞
- [ ] –°—Ç–∞—Ç—É—Å —á–µ–∫–∞ –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ "–û–±—Ä–∞–±–æ—Ç–∞–Ω" ‚úÖ

**–¢–µ—Å—Ç 3: Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ–∫
- [ ] –ù–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –£–≤–∏–¥–µ—Ç—å —Å–º–µ–Ω—É —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
  - ‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
  - üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
  - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω

**–¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
- [ ] –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–µ–∫–∞
- [ ] –¢–æ–≤–∞—Ä—ã –¥–æ–±–∞–≤–∏–ª–∏—Å—å –≤ —Å–ø–∏—Å–æ–∫
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å
- [ ] –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —á–µ–∫ –∏–∑ –æ—á–µ—Ä–µ–¥–∏

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Vercel:**
- [ ] –ü–µ—Ä–µ–π—Ç–∏ –≤ Vercel Dashboard ‚Üí Functions
- [ ] –û—Ç–∫—Ä—ã—Ç—å `/api/process-receipt`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Supabase:**
- [ ] Database ‚Üí pending_receipts
- [ ] –ï—Å—Ç—å –∑–∞–ø–∏—Å–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏
- [ ] Storage ‚Üí receipts
- [ ] –ï—Å—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 1-3 —Å–µ–∫—É–Ω–¥—ã
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ–∫–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–∞ 10-30 —Å–µ–∫—É–Ω–¥
- [ ] Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç —Å—Ä–∞–∑—É
- [ ] –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫ –≤ UI

## –û—Ç–∫–∞—Ç (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Ç–∫–∞—Ç –∫–æ–¥–∞
```bash
git revert HEAD
git push origin main
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–∫–∞—Ç –≤ Vercel
1. Vercel Dashboard ‚Üí Deployments
2. –ù–∞–π—Ç–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–ø–ª–æ–π
3. –ù–∞–∂–∞—Ç—å "‚ãØ" ‚Üí "Promote to Production"

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û—Ç–∫–ª—é—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
–í `src/GroceryTrackerApp.tsx` –≤—Ä–µ–º–µ–Ω–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É:
```typescript
// –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥
// const pendingReceipt = await SupabaseService.uploadReceiptForProcessing(...);

// –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥
const parsedReceipt = await parseReceiptImage(file);
await SupabaseService.processReceipt(...);
```

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –û—à–∏–±–∫–∞ "Bucket not found"
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å bucket "receipts" –≤ Supabase Storage

### ‚ùå –û—à–∏–±–∫–∞ "Permission denied"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –≤ Storage

### ‚ùå –ß–µ–∫ –∑–∞—Å—Ç—Ä—è–ª –≤ "pending"
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Vercel
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –í—Ä—É—á–Ω—É—é –≤—ã–∑–≤–∞—Ç—å API:
```bash
curl -X POST https://your-app.vercel.app/api/process-receipt \
  -H "Content-Type: application/json" \
  -d '{"pendingReceiptId": 123}'
```

### ‚ùå Realtime –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å Realtime –¥–ª—è pending_receipts –≤ Supabase

### ‚ùå –û—à–∏–±–∫–∞ Perplexity API
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PERPLEXITY_API_KEY –∏ –ª–∏–º–∏—Ç—ã API

## –ì–æ—Ç–æ–≤–æ! üéâ

–ï—Å–ª–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –æ—Ç–º–µ—á–µ–Ω—ã ‚úÖ, —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ–∫–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç!

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –≤ Vercel –¥–ª—è –æ—à–∏–±–æ–∫
- [ ] –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Storage
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–µ–∫–æ–≤

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É –¥–ª—è failed —á–µ–∫–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –û–±–Ω–æ–≤–∏—Ç—å README.md
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –Ω–æ–≤–æ–≥–æ UI
- [ ] –°–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

